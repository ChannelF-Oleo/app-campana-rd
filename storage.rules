rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Aplica a todos los archivos en el almacenamiento
    match /{allPaths=**} {
      // 1. PERMITIR LECTURA:
      // Opción A (Segura): Solo usuarios que han iniciado sesión pueden ver las fotos
      allow read: if request.auth != null;

      // Opción B (Pública - Solo para probar si falla la autenticación):
      // allow read: if true; 

      // 2. PERMITIR ESCRITURA:
      // Solo usuarios autenticados pueden subir archivos
      allow write: if request.auth != null;
    }
  }
}